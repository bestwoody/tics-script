>> drop table if exists test
>> create table test (
	dt Date,
	k Int32,
	v Int32
	) engine = MutableMergeTree(dt, (k), 8192)

>> insert into test values (0, 1, 11), (0, 2, 22), (0, 3, 33), (0, 4, 44)
>> select * from test
┌─────────dt─┬─k─┬──v─┐
│ 0000-00-00 │ 1 │ 11 │
│ 0000-00-00 │ 2 │ 22 │
│ 0000-00-00 │ 3 │ 33 │
│ 0000-00-00 │ 4 │ 44 │
└────────────┴───┴────┘

>> upsert into test values (0, 2, 44), (0, 3, 66)

>> select * from test
┌─────────dt─┬─k─┬──v─┐
│ 0000-00-00 │ 1 │ 11 │
│ 0000-00-00 │ 4 │ 44 │
└────────────┴───┴────┘
┌─────────dt─┬─k─┬──v─┐
│ 0000-00-00 │ 2 │ 44 │
│ 0000-00-00 │ 3 │ 66 │
└────────────┴───┴────┘

>> selraw * from test
┌─────────dt─┬─k─┬──v─┬─_INTERNAL_VERSION─┬─_INTERNAL_DELMARK─┐
│ 0000-00-00 │ 1 │ 11 │           1000000 │                 0 │
│ 0000-00-00 │ 2 │ 22 │           1000001 │                 0 │
│ 0000-00-00 │ 3 │ 33 │           1000002 │                 0 │
│ 0000-00-00 │ 4 │ 44 │           1000003 │                 0 │
└────────────┴───┴────┴───────────────────┴───────────────────┘
┌─────────dt─┬─k─┬──v─┬─_INTERNAL_VERSION─┬─_INTERNAL_DELMARK─┐
│ 0000-00-00 │ 2 │ 44 │           2000000 │                 0 │
│ 0000-00-00 │ 3 │ 66 │           2000000 │                 0 │
└────────────┴───┴────┴───────────────────┴───────────────────┘

>> drop table if exists test
